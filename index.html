
<!DOCTYPE html>
<html>
  <head>
    <title>Monitoreo en Tiempo Real</title>
    <meta charset="utf-8" />
    <style>
      #map {
        height: 90vh;
        width: 100%;
      }
    </style>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCtPd5A0Izvtps_f0-7tzg_x-DF-bxeAtA"></script>
  </head>
  <body>
    <h2>Ubicaci√≥n en tiempo real</h2>
    <div id="map"></div>

    <script>
      let map;
      let marker;

      async function obtenerUltimaUbicacion() {
        const response = await fetch(
          "https://opensheet.vercel.app/1xACgCqeUKtcwuvIM7DSo3Qhdqz_ucE2e9Ev5sYHogWs/Ubicacion_En_Tiempo_Real"
        );
        const datos = await response.json();
        const ultima = datos[datos.length - 1];

        return {
          lat: parseFloat(ultima.Latitud),
          lng: parseFloat(ultima.Longitud),
        };
      }

      async function initMap() {
        const posicion = await obtenerUltimaUbicacion();

        map = new google.maps.Map(document.getElementById("map"), {
          center: posicion,
          zoom: 15,
        });

        marker = new google.maps.Marker({
          position: posicion,
          map: map,
        });

        setInterval(async () => {
          const nuevaPosicion = await obtenerUltimaUbicacion();
          marker.setPosition(nuevaPosicion);
          map.setCenter(nuevaPosicion);
        }, 10000);
      }

      window.onload = initMap;
    </script>
  </body>
</html>
